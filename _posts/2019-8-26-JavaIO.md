---
layout:     post
title:      "Java I/O"
subtitle:   ""
date:       2019-08-26 14:00:00
author:     "Cfeng"
header-img: "img/home-bg-o.jpg"
catalog: true
tags:
- Java巩固
---
Java 的 I/O 大概可以分成以下几类：      
     
* 磁盘操作：File  
* 字节操作：InputStream 和 OutputStream   
* 字符操作：Reader 和 Writer  
* 对象操作：Serializable  
* 网络操作：Socket  
* 新的输入/输出：NIO   

## 同步与异步

同步： 同步就是发起一个调用后，被调用者未处理完请求之前，调用不返回。    
异步： 异步就是发起一个调用后，立刻得到被调用者的回应表示已接收到请求，但是被调用者并没有返回结果，此时我们可以处理其他的请求，被调用者通常依靠事件，回调等机制来通知调用者其返回结果。    

同步和异步的区别最大在于异步的话调用者不需要等待处理结果，被调用者会通过回调等机制来通知调用者其返回结果。       

## 阻塞和非阻塞

阻塞： 阻塞就是发起一个请求，调用者一直等待请求结果返回，也就是当前线程会被挂起，无法从事其他任务，只有当条件就绪才能继续。    
非阻塞： 非阻塞就是发起一个请求，调用者不用一直等着结果返回，可以先去干其他事情。     
     
     
举个生活中简单的例子，你妈妈让你烧水，小时候你比较笨啊，在那里傻等着水开（同步阻塞）。等你稍微再长大一点，你知道每次烧水的空隙可以去干点其他事，然后只需要时不时来看看水开了没有（同步非阻塞）。后来，你们家用上了水开了会发出声音的壶，这样你就只需要听到响声后就知道水开了，在这期间你可以随便干自己的事情，你需要去倒水了（异步非阻塞）。      


     
## 序列化
序列化就是将一个对象转换成字节序列，方便存储和传输。   
  
* 序列化：ObjectOutputStream.writeObject()  
* 反序列化：ObjectInputStream.readObject()  
     
不会对静态变量进行序列化，因为序列化只是保存对象的状态，静态变量属于类的状态。    
序列化的类需要实现 Serializable 接口，它只是一个标准，没有任何方法需要实现，但是如果不去实现它的话而进行序列化，会抛出异常。   
transient 关键字可以使一些属性不会被序列化。     

## BIO   
**同步阻塞**I/O模式，数据的读取写入必须阻塞在一个线程内等待其完成   

## NIO  
**同步非阻塞**的I/O模型    
新的输入/输出 (NIO) 库是在 JDK 1.4 中引入的，弥补了原来的 I/O 的不足，提供了高速的、面向块的 I/O。   
     
**流与块:**        
I/O 与 NIO 最重要的区别是数据打包和传输的方式，I/O 以流的方式处理数据，而 NIO 以**块**的方式处理数据。
     
**通道与缓冲区:**   
通道 Channel 是对原 I/O 包中的流的模拟，可以通过它读取和写入数据。   
通道是双向的，可以用于读、写或者同时用于读写    
     
发送给一个通道的所有数据都必须首先放到缓冲区中，同样地，从通道中读取的任何数据都要先读到缓冲区中。          

**Non-blocking IO（非阻塞IO）**
IO流是阻塞的，NIO流是不阻塞的。    
Java NIO使我们可以进行非阻塞IO操作。比如说，单线程中从通道读取数据到buffer，同时可以继续做别的事情，当数据读取到buffer中后，线程再继续处理数据。写数据也是一样的。另外，非阻塞写也是如此。一个线程请求写入一些数据到某通道，但不需要等待它完全写入，这个线程同时可以去做别的事情。    
Java IO的各种流是阻塞的。这意味着，当一个线程调用 read() 或 write() 时，该线程被阻塞，直到有一些数据被读取，或数据完全写入。该线程在此期间不能再干任何事情了      
    
**Selectors(选择器)**   
NIO有选择器，而IO没有    
一个线程 Thread 使用一个选择器 Selector 通过轮询的方式去监听多个通道 Channel 上的事件，从而让一个线程就可以处理多个事件      


NIO 与普通 I/O 的区别主要有以下两点：      
1. NIO 是非阻塞的；    
2. NIO 面向块，I/O 面向流。
3. NIO 有选择器，I/O没有     

## AIO (Asynchronous I/O)         
AIO 也就是 NIO 2。在 Java 7 中引入了 NIO 的改进版 NIO 2,它是异步非阻塞的IO模型。异步 IO 是基于事件和回调机制实现的，也就是应用操作之后会直接返回，不会堵塞在那里，当后台处理完成，操作系统会通知相应的线程进行后续的操作。      
     
          



      